// Actualizează ascultătorul Firebase în scriptul de pe laptop
remoteDb.on('value', (snapshot) => {
    const data = snapshot.val();
    if (!data) return;

    // A. LOGICA PENTRU TEXT (Invitați sau Telecomandă)
    // Căutăm mesajul fie în 'text' (invitați), fie în 'val' (telecomandă)
    const mesajPrimit = data.text || data.val;

    if (mesajPrimit && (data.text || data.cmd === 'SET_TEXT')) {
        const textElement = document.getElementById('branding');
        
        // Actualizăm textul
        textElement.innerText = mesajPrimit;

        // Resetăm animația pentru ca mesajul nou să apară imediat din dreapta
        textElement.style.animation = 'none';
        textElement.offsetHeight; /* Forțează browserul să proceseze schimbarea */
        textElement.style.animation = 'marquee 15s linear infinite';
        
        console.log("Mesaj nou afișat:", mesajPrimit);
    }

    // B. LOGICA PENTRU COMENZI TELECOMANDĂ (Fundaluri, AI, etc.)
    // Verificăm timpul pentru a nu repeta comenzi vechi la refresh
    if (data.time && (Date.now() - data.time < 5000)) {
        switch (data.cmd) {
            case 'TOGGLE_VIDEO': toggleVideoBackground(); break;
            case 'TOGGLE_PHOTO': togglePhotoBackground(); break;
            case 'TOGGLE_SLIDE': toggleSlideshow(); break;
            case 'START_AI': initCam(); break;
            case 'TOGGLE_SETUP_UI': 
                const ui = document.querySelector('.ui-container');
                ui.style.display = (ui.style.display === 'none' ? 'grid' : 'none');
                break;
            // Adaugă aici și restul de case-uri dacă mai ai
        }
    }
});
